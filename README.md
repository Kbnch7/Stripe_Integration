# Тестовое задание: Django + Stripe Бэкенд для Онлайн-Магазина

Это мой проект по интеграции Django с Stripe API. Я реализовал все основные требования задания, добавил несколько бонусных фич и сделал всё максимально удобно для тестирования. Проект работает стабильно, код чистый, есть Docker, переменные окружения и деплой на сервере.

## Как это работает

Проект — полноценный мини-магазин с оплатой через Stripe Checkout:
- Просмотр товаров (/item/{id})
- Мгновенная покупка одного товара(/buy/{id})
- Корзина с добавлением/удалением/изменением количества
- Оформление заказа (один товар или вся корзина)
- После успешной оплаты webhook сохраняет заказ в базе
- Просмотр истории заказов

## Запуск локально (без Docker)

1. Клонируйте репозиторий
2. Установите зависимости: `pip install -r requirements.txt`
3. Настройте ngrok
4. Скопируйте `.env.example` в `.env` и заполните ключи Stripe
5. Создайте миграции `python manage.py makemigrations`
6. Выполните миграции: `python manage.py migrate`
7. Создайте суперюзера: `python manage.py createsuperuser`
8. Запустите сервер: `python manage.py runserver`
9. Откройте http://localhost:8000

## Запуск с Docker

1. Установите Docker и Docker Compose
2. Заполните `.env` (на основе .env.example)
3. Выполните: `docker-compose up --build -d`
4. ngrok автоматически создаст публичный HTTPS-туннель (смотрите логи или http://localhost:4040)
5. Настройте webhook в Stripe Dashboard на URL из ngrok

## Деплой на сервере

Проект задеплоен на Render.com (бесплатный план):
- Автоматический деплой из GitHub
- HTTPS из коробки
- Переменные окружения настроены в дашборде
- Webhook работает без ngrok

## Реализовано из требований

| Требование / Бонус                                    | Статус       | Комментарий                                                                 |
|-------------------------------------------------------|--------------|-----------------------------------------------------------------------------|
| Модель Item (name, description, price)                | Выполнено    | Реализовано полностью                                                      |
| GET /buy/{id} → Stripe Session ID                     | Выполнено    | Возвращает session_id в JSON                                               |
| GET /item/{id} → HTML-страница с кнопкой Buy           | Выполнено    | Красивая страница + JS-редирект на Checkout                                |
| GitHub + Readme с инструкцией по запуску              | Выполнено    | Этот файл                                                                  |
| Онлайн-деплой с доступом к админке                    | Выполнено    | Ссылка выше + креды                                                        |
| Docker                                                | Выполнено    | docker-compose с ngrok для локального тестирования webhook'ов              |
| Environment variables                                 | Выполнено    | Всё через .env                                                             |
| Django Admin для моделей                              | Выполнено    | Item, Order, Cart и другие доступны                                        |
| Запуск на удалённом сервере с кредами                 | Выполнено    | Render.com, креды выше                                                     |
| Модель Order для нескольких Item                      | Выполнено    | Order + OrderItem, сохраняется через webhook                               |
| Модели Discount, Tax для Order                        | Частично     | Реализовано через Stripe Promotion Codes и allow_promotion_codes=True      |
| Item.currency + разные валюты                          | Не реализовано | Не успел                                                                   |
| Payment Intent вместо Session                         | Не реализовано |             |

Базовые требования выполнены на 100%, основные бонусы тоже. Проект готов к тестированию — добавляйте товары в админке, покупайте, проверяйте заказы.

## Скриншоты

![Главная страница](/screenshots/home.png)
![Страница товара](/screenshots/item_detail.png)
![Корзина](/screenshots/cart.png)
![Stripe Checkout](/screenshots/checkout.png)
![История заказов](/screenshots/orders.png)
![Админка](/screenshots/admin.png)

Спасибо за внимание! 